(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[4],{158:function(e,t,n){},209:function(e,t,n){},21:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l}));var r=n(17),a=n(0),o=n(78),c=n.n(o),i=n(5),s=Object(a.createContext)(),l=function(e){var t=e.children,n=Object(a.useState)("light"),o=Object(r.a)(n,2),l=o[0],u=o[1],d=Object(a.useState)(null),p=Object(r.a)(d,2),b=p[0],j=p[1],f=c()("http://localhost:4001");return Object(a.useEffect)((function(){var e=localStorage.getItem("theme");e&&u(e)}),[,]),Object(i.jsx)(s.Provider,{value:{theme:l,setTheme:function(e){localStorage.setItem("theme",e),u(e)},user:b,setUser:j,socket:f,url:"http://localhost:4000"},children:t})}},212:function(e,t,n){},213:function(e,t,n){},215:function(e,t,n){},217:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(11),o=n.n(a),c=(n(158),n(269)),i=n(55),s=n(268),l=n(12),u=n(104),d=n(8),p=n.n(d),b=n(16),j=n(17),f=n(275),h=n(219),v=n(264),O=n(21),m=n(22),x=n(52),g=n(271),w=n(73),k=n(71),y=n(72),C=(n(209),n(5)),S=function(){var e,t,n=Object(w.b)({mode:"all",shouldUnregister:!1}),a=n.handleSubmit,o=n.errors,c=n.control,i=Object(r.useState)(""),s=Object(j.a)(i,2),u=s[0],d=s[1],S=Object(r.useState)(""),T=Object(j.a)(S,2),U=T[0],N=T[1],P=Object(r.useState)(!1),z=Object(j.a)(P,2),E=z[0],A=z[1],I=Object(r.useState)(null),L=Object(j.a)(I,2),W=L[0],B=L[1],R=Object(l.f)(),F=Object(r.useContext)(O.a),J=(F.url,F.setUser),q=function(){var e=Object(b.a)(p.a.mark((function e(t){var n,r,a,o,c,i,s,l,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.email,r=t.password,A(!0),n&&r){e.next=4;break}return e.abrupt("return",B("Incorrect email or password"));case 4:return e.prev=4,e.next=7,Object(x.b)("/login","POST",{email:n,password:r});case 7:a=e.sent,o=a.status,c=a.data,200===o&&c.username&&c.role&&(J(c),m.set("user",JSON.stringify(c),{expires:14}),m.set("token",c.token,{expires:14}),R.push("/")),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),(null===e.t0||void 0===e.t0||null===(i=e.t0.response)||void 0===i||null===(s=i.data)||void 0===s?void 0:s.error)?B(null===e.t0||void 0===e.t0||null===(l=e.t0.response)||void 0===l||null===(u=l.data)||void 0===u?void 0:u.error):B(e.t0.message);case 15:A(!1);case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(C.jsxs)("div",{className:"login",children:[Object(C.jsx)(h.a,{className:"icon",variant:"h2",component:"span",children:Object(C.jsx)(k.a,{icon:y.f})}),Object(C.jsx)(h.a,{className:"title",variant:"h3",component:"h1",children:"Sign In"}),Object(C.jsxs)("form",{onSubmit:a(q),children:[Object(C.jsx)(w.a,{as:f.a,className:"email",name:"email",label:"email",type:"email",variant:"outlined",autoComplete:"email",defaultValue:u,onChange:function(e){return d(e.target.value)},control:c,error:!!o.email,helperText:null===(e=o.email)||void 0===e?void 0:e.message,rules:{required:"Required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i,message:"invalid email address"}}}),Object(C.jsx)(w.a,{as:f.a,className:"password",name:"password",label:"password",type:"password",variant:"outlined",autoComplete:"current-password",defaultValue:U,onChange:function(e){return N(e.target.value)},control:c,error:!!o.password,helperText:null===(t=o.password)||void 0===t?void 0:t.message,rules:{required:"Required"}}),W?Object(C.jsx)(g.a,{className:"alert",severity:"success",color:"error",children:W}):null,Object(C.jsxs)(v.a,{variant:"contained",color:"primary",type:"submit",value:"login",children:["Login ",E?"...":null]})]})]})},T=(n(212),function(){var e=Object(l.f)(),t=Object(r.useContext)(O.a),n=(t.url,t.setUser);return Object(r.useEffect)((function(){Object(x.b)("/logout","GET"),n(null),m.remove("user"),e.push("/login")}),[,]),Object(C.jsx)("div",{className:"logout",children:Object(C.jsx)(k.a,{icon:y.e})})}),U=n(47),N=n(140),P=n(265),z=(n(213),function(){return Object(C.jsx)("div",{className:"spinner-container",children:Object(C.jsx)(P.a,{})})}),E=function(e){var t=e.component,n=Object(N.a)(e,["component"]),a=Object(r.useContext)(O.a).user;return function(){var e=Object(l.f)(),t=Object(r.useContext)(O.a),n=t.user,a=t.setUser,o=function(){var t=Object(b.a)(p.a.mark((function t(){var n,r,o;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(x.b)("/checkRole","GET");case 3:n=t.sent,r=n.status,o=n.data,200===r&&o.username&&o.role?(a(o),m.set("user",JSON.stringify(o),{expires:14}),m.set("token",o.token,{expires:14})):(a(null),e.push("/login")),t.next=13;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0),a(null),e.push("/login");case 13:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}();Object(r.useEffect)((function(){setTimeout((function(){if(!n){var e=m.get("user");if(e){var t=JSON.parse(e);console.log(t),t?a(t):o()}else o()}}),1e3)}),[,])}(),a?Object(C.jsx)(l.a,Object(U.a)(Object(U.a)({},n),{},{render:function(e){return Object(C.jsx)(t,Object(U.a)({},e))}})):Object(C.jsx)(z,{})},A=n(274),I=n(266),L=n(267),W=n(82),B=n(135),R=n.n(B),F=n(134),J=n.n(F),q=function(){var e=Object(r.useContext)(W.a),t=e.incommingCall,n=e.setIncommingCall;return Object(C.jsxs)(A.a,{open:!!t,onClose:function(){return n(null)},fullWidth:!0,children:[Object(C.jsxs)(I.a,{id:"form-dialog-title",children:["Incomming call from group ",null===t||void 0===t?void 0:t.name]}),Object(C.jsxs)(L.a,{children:[Object(C.jsx)(v.a,{target:"_blank",href:"/VideoCall/".concat(null===t||void 0===t?void 0:t._id),onClick:function(){return setTimeout((function(){n(null)}),1e3)},color:"primary",children:Object(C.jsx)(J.a,{})}),Object(C.jsx)(v.a,{color:"primary",onClick:function(){return n(null)},children:Object(C.jsx)(R.a,{})})]})]})},G=(n(215),n(216),Object(r.lazy)((function(){return n.e(15).then(n.bind(null,379))}))),V=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(2),n.e(3),n.e(14),n.e(10)]).then(n.bind(null,391))})),Z=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(3),n.e(1),n.e(9),n.e(12)]).then(n.bind(null,395))})),_=Object(r.lazy)((function(){return Promise.all([n.e(16),n.e(17)]).then(n.bind(null,396))})),$=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(2),n.e(1),n.e(11),n.e(8)]).then(n.bind(null,390))})),D=Object(r.lazy)((function(){return Promise.all([n.e(7),n.e(13)]).then(n.bind(null,397))})),H=function(){var e,t=Object(r.useContext)(O.a).theme,n=(e=t,Object(u.a)({palette:{type:e},overrides:{MuiList:{root:{listStyle:"none"}}}}));return Object(C.jsxs)(s.a,{theme:n,children:[Object(C.jsx)(c.a,{}),Object(C.jsxs)("div",{className:"App",children:[Object(C.jsx)(q,{}),Object(C.jsx)(r.Suspense,{fallback:Object(C.jsx)(z,{}),children:Object(C.jsxs)(l.c,{children:[Object(C.jsx)(E,{exact:!0,path:"/",component:G}),Object(C.jsx)(E,{path:"/groups",component:$}),Object(C.jsx)(E,{path:"/videoCall/:id",component:D}),Object(C.jsx)(E,{path:"/calendar",component:V}),Object(C.jsx)(E,{path:"/files",component:Z}),Object(C.jsx)(E,{path:"/account",component:_}),Object(C.jsx)(l.a,{path:"/logout",component:T}),Object(C.jsx)(l.a,{path:"/login",component:S})]})}),Object(C.jsx)(i.a,{position:"bottom-right",autoClose:7e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0})]})]})},M=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function K(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Q=function(e){e&&e instanceof Function&&n.e(18).then(n.bind(null,389)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),o(e),c(e)}))},X=n(43);o.a.render(Object(C.jsx)(O.b,{children:Object(C.jsx)(W.b,{children:Object(C.jsx)(X.a,{children:Object(C.jsx)(H,{})})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/remoTalky.client",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/remoTalky.client","/service-worker.js");M?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):K(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):K(t,e)}))}}(),Q()},48:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={apiUrl:"https://vps.franciszekpawlak.pl:17200",chatSocektUrl:"https://vps.franciszekpawlak.pl:17300",videoSocketUlr:"https://vps.franciszekpawlak.pl:17400"}},52:function(e,t,n){"use strict";n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return j})),n.d(t,"d",(function(){return f})),n.d(t,"a",(function(){return h}));var r=n(8),a=n.n(r),o=n(47),c=n(16),i=n(69),s=n.n(i),l=n(55),u=function(e){var t=new Blob([e],{type:e.type});if("function"===typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(e,"file");else{var n=t,r=document.createElement("a");r.href=window.URL.createObjectURL(n),r.download="file",document.body.appendChild(r),r.click()}},d=n(48),p=n(22),b=function(){var e=Object(c.a)(a.a.mark((function e(t,n,r,c){var i,u,b,j,f=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=f.length>4&&void 0!==f[4]?f[4]:{"Content-Type":"application/json"},u=p.get("token"),e.prev=2,e.next=5,s()({method:n,url:"".concat(d.a.apiUrl).concat(t),headers:Object(o.a)(Object(o.a)({},i),{},{Authorization:u}),data:c,withCredentials:!0});case 5:(b=e.sent).data?r(b.data):l.b.error("Invalid data"),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),console.error(e.t0),l.b.error(null===e.t0||void 0===e.t0||null===(j=e.t0.response)||void 0===j?void 0:j.statusText);case 13:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t,n,r,a){return e.apply(this,arguments)}}(),j=function(){var e=Object(c.a)(a.a.mark((function e(t){var n,r,o,c,i=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:"GET",r=i.length>2&&void 0!==i[2]?i[2]:null,o=p.get("token"),e.next=5,s()({method:n,url:"".concat(d.a.apiUrl).concat(t),headers:{"Content-Type":"application/json",Authorization:o},data:r,withCredentials:!0});case 5:return c=e.sent,e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(c.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=p.get("token"),e.next=3,s()({url:"".concat(d.a.apiUrl).concat(t),headers:{"Content-Type":"application/json",Authorization:n},withCredentials:!0});case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(c.a)(a.a.mark((function e(t,n){var r,o,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=p.get("token"),e.prev=1,e.next=4,s()({url:"".concat(d.a.apiUrl).concat(t),method:"POST",data:n,withCredentials:!0,responseType:"blob",headers:{Authorization:r}});case 4:o=e.sent,u(o.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),l.b.error(null===e.t0||void 0===e.t0||null===(c=e.t0.response)||void 0===c?void 0:c.statusText);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}()},82:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var r=n(17),a=n(0),o=n(21),c=n(78),i=n.n(c),s=n(48),l=n(5),u=Object(a.createContext)(),d=function(e){var t=e.children,n=Object(a.useContext)(o.a).user,c=Object(a.useState)(!1),d=Object(r.a)(c,2),p=d[0],b=d[1],j=Object(a.useState)(null),f=Object(r.a)(j,2),h=f[0],v=f[1],O=Object(a.useRef)();return Object(a.useEffect)((function(){return O.current=i.a.connect(s.a.videoSocketUlr,{path:"/socket.io/webrtc"}),O.current.on("incomming call",(function(e){v(e)})),function(){return O.current.emit("disconnect")}}),[,]),Object(a.useEffect)((function(){n&&!p&&(O.current.emit("login",n),b(!0))}),[n]),Object(l.jsx)(u.Provider,{value:{socket:O,incommingCall:h,setIncommingCall:v},children:t})}}},[[217,5,6]]]);
//# sourceMappingURL=main.2b2e58e7.chunk.js.map