(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[8],{280:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n(0);var c=n(71),s=n(72),a=n(43),r=(n(281),n(5)),i=function(e){var t=e.children;return Object(r.jsxs)("div",{children:[Object(r.jsx)("nav",{children:Object(r.jsxs)("ul",{children:[Object(r.jsx)("li",{children:Object(r.jsx)(a.b,{to:"/groups","aria-label":"groups",children:Object(r.jsx)(c.a,{icon:s.c})})}),Object(r.jsx)("li",{children:Object(r.jsx)(a.b,{to:"/calendar","aria-label":"calendar",children:Object(r.jsx)(c.a,{icon:s.a})})}),Object(r.jsx)("li",{children:Object(r.jsx)(a.b,{to:"/files","aria-label":"files",children:Object(r.jsx)(c.a,{icon:s.d})})}),Object(r.jsx)("li",{children:Object(r.jsx)(a.b,{to:"/account","aria-label":"account",children:Object(r.jsx)(c.a,{icon:s.b})})})]})}),Object(r.jsx)("main",{children:t})]})}},281:function(e,t,n){},328:function(e,t,n){},329:function(e,t,n){},331:function(e,t,n){},332:function(e,t,n){},333:function(e,t,n){},334:function(e,t,n){},335:function(e,t,n){},390:function(e,t,n){"use strict";n.r(t);var c=n(0),s=n(280),a=n(295),r=n(47),i=n(14),o=n(8),l=n.n(o),u=n(16),j=n(17),b=n(21),d=n(5),O=Object(c.createContext)(),p=function(e){var t=e.children,n=Object(c.useState)(!1),s=Object(j.a)(n,2),a=s[0],r=s[1],i=Object(c.useState)(null),o=Object(j.a)(i,2),l=o[0],u=o[1],b=Object(c.useState)(null),p=Object(j.a)(b,2),f=p[0],h=p[1],m=Object(c.useState)(!0),x=Object(j.a)(m,2),v=x[0],g=x[1];return Object(d.jsx)(O.Provider,{value:{open:a,setOpen:r,groupMobile:l,setGroupMobile:u,groupDesktop:f,setGroupDesktop:h,desktopInitScroll:v,setDesktopInitScroll:g},children:t})},f=n(274),h=n(266),m=n(381),x=n(388),v=n(356),g=n(275),S=n(267),k=n(264),C=n(393),N=n(52),y=n(292),_=Object(c.createContext)(),G=function(e){var t=e.children,n=Object(c.useState)([]),s=Object(j.a)(n,2),a=s[0],r=s[1],i=Object(c.useState)(""),o=Object(j.a)(i,2),l=o[0],u=o[1],b=Object(c.useState)(!1),O=Object(j.a)(b,2),p=O[0],f=O[1],h=Object(y.a)("/group/getListWithNotification",N.d,{onSuccess:function(e){return p?null:r(e)},refreshInterval:5e3}).data;return Object(d.jsx)(_.Provider,{value:{groupList:a,setGroupList:r,searchGroup:function(e){u(e);var t=h.filter((function(t){return t.group.name.includes(e)}));r(t)},setIsSearching:f,searchingPhrase:l,setSearchingPhrase:u},children:t})},I=function(){Object(c.useContext)(b.a).url;var e=Object(c.useContext)(O),t=e.open,n=e.setOpen,s=e.setGroupMobile,a=e.setGroupDesktop,o=Object(c.useContext)(_),p=o.setGroupList,y=o.groupList,G=Object(c.useState)(null),I=Object(j.a)(G,2),M=I[0],D=I[1],P=Object(c.useState)(null),z=Object(j.a)(P,2),E=z[0],L=z[1],A=Object(c.useState)([]),W=Object(j.a)(A,2),w=W[0],F=W[1];Object(c.useEffect)((function(){return V(),D([])}),[,]);var T=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null===M||void 0===M?void 0:M.map((function(e){return e.id}))){e.next=3;break}return e.abrupt("return");case 3:Object(N.c)("/group/create","POST",B,{users:t,name:E});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(){return Object(N.c)("/users","GET",F)},B=function(e){p([{group:e,notSeenMessages:0}].concat(Object(i.a)(y))),a(e),s(e),n(!1)};return Object(d.jsxs)(f.a,{open:t,onClose:function(){return n(!1)},fullWidth:!0,children:[Object(d.jsx)(h.a,{id:"form-dialog-title",children:"Create Group"}),Object(d.jsxs)(m.a,{children:[Object(d.jsx)(x.a,{children:"Select group users."}),Object(d.jsx)(v.a,{py:1,children:Object(d.jsx)(C.a,{multiple:!0,options:w,getOptionLabel:function(e){return e.username},filterSelectedOptions:!0,fullWidth:!0,onChange:function(e,t){return D(t)},renderInput:function(e){return Object(d.jsx)(g.a,Object(r.a)(Object(r.a)({},e),{},{variant:"outlined",label:"select users",placeholder:"select users"}))}})}),Object(d.jsx)(v.a,{py:1,children:Object(d.jsx)(g.a,{name:"group name",label:"group name",type:"text",variant:"outlined",defaultValue:"",fullWidth:!0,onChange:function(e){return L(e.target.value)}})})]}),Object(d.jsxs)(S.a,{children:[Object(d.jsx)(k.a,{onClick:function(){return n(!1)},color:"primary",children:"Cancel"}),Object(d.jsx)(k.a,{onClick:T,color:"primary",children:"Create"})]})]})},M=n(382),D=n(398),P=n(297),z=n.n(P),E=n(298),L=n.n(E),A=n(290),W=n.n(A),w=(n(328),function(){var e=Object(c.useContext)(O),t=e.groupDesktop,n=e.setGroupDesktop,s=e.setOpen,a=e.setDesktopInitScroll,r=Object(c.useContext)(_),i=r.groupList,o=r.searchGroup,l=r.setIsSearching,u=r.searchingPhrase,j=r.setSearchingPhrase;return Object(c.useEffect)((function(){!t&&(null===i||void 0===i?void 0:i.length)>0&&n(i[0].group)})),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(g.a,{className:"conversation-search",placeholder:"find conversation",variant:"outlined",fullWidth:!0,size:"small",value:u,onChange:function(e){""===e.target.value?(l(!1),j("")):(l(!0),o(e.target.value))},InputProps:{endAdornment:Object(d.jsx)("span",{children:Object(d.jsx)(z.a,{className:"conversation-search-icon",color:"primary",fontSize:"small",onClick:function(){return s(!0)}})})}}),Object(d.jsx)("div",{className:"desktop-conversations-container",children:null===i||void 0===i?void 0:i.map((function(e){var c=e.notSeenMessages,s=e.group;return Object(d.jsxs)("div",{className:"".concat((null===t||void 0===t?void 0:t._id)===s._id?"conversation-active":""," conversations-item"),children:[Object(d.jsxs)("div",{className:"conversation-item-text-container",onClick:function(){a(!0),n(s)},children:[c>0?Object(d.jsx)(M.a,{max:99,badgeContent:c,color:"primary",anchorOrigin:{vertical:"top",horizontal:"right"},children:Object(d.jsx)(D.a,{children:s.users.length>2?Object(d.jsx)(L.a,{}):null})}):Object(d.jsx)(D.a,{children:s.users.length>2?Object(d.jsx)(L.a,{}):null}),Object(d.jsx)("span",{className:"conversation-item-text",children:s.name})]}),Object(d.jsx)("a",{className:"conversation-video-link",href:"/remoTalky.client/#/videoCall/".concat(s._id),target:"_blank",rel:"noreferrer",children:Object(d.jsx)(W.a,{})})]},s._id)}))})]})}),F=n(78),T=n.n(F),V=n(383),B=n(330),J=n.n(B),R=(n(329),function(e){var t=e.message,n=e.type,s=Object(c.useContext)(b.a).user,a=Object(c.useContext)(O),r=a.groupMobile,i=a.groupDesktop,o=Object(c.useState)([]),l=Object(j.a)(o,2),u=l[0],p=l[1],f=u.filter((function(e){return t.seen.includes(e._id)&&t.user._id!==e._id})),h=t.seen.filter((function(e){return e!==s.id}));return Object(c.useEffect)((function(){p("mobile"===n?r.users:i.users)}),[,]),Object(d.jsxs)("span",{className:"".concat(t.user._id===s.id?"message-right":"message-left"," message-container"),children:[(null===h||void 0===h?void 0:h.length)>0&&t.user._id===s.id?Object(d.jsx)("span",{className:"message-icons",children:h.map((function(e){return Object(d.jsx)(J.a,{},e)}))}):null,Object(d.jsx)(V.a,{enterTouchDelay:10,placement:t.user._id===s.id?"left":"right",title:Object(d.jsxs)("span",{className:"message-tooltip",children:[Object(d.jsx)("span",{children:new Date(t.createDate).toLocaleString()}),Object(d.jsxs)("span",{children:["From ",t.user.username]}),Object(d.jsxs)("span",{children:["Seen: ",f.map((function(e){return e.username+" "}))]})]}),children:Object(d.jsx)("span",{className:"".concat(t.user._id===s.id?"message-dark":"message-light"," message-text"),children:Object(d.jsx)("span",{children:t.text})})}),(null===h||void 0===h?void 0:h.length)>0&&t.user._id!==s.id?Object(d.jsx)("span",{className:"message-icons",children:h.map((function(e){return Object(d.jsx)(J.a,{},e)}))}):null]},t._id)}),U=n(300),Q=n.n(U),q=n(399),H=n(271),K=n(263),X=n(299),Y=n.n(X),Z=(n(331),function(e){var t=e.type,n=e.message,c=e.closeAction;return Object(d.jsx)(q.a,{open:!0,color:"primary",children:Object(d.jsxs)(H.a,{severity:t,className:"toast",children:[n,Object(d.jsx)(K.a,{"aria-label":"close",color:"inherit",onClick:c,children:Object(d.jsx)(Y.a,{})})]}),anchorOrigin:{vertical:"bottom",horizontal:"left"}})}),$=(n(332),n(48)),ee=function(){var e=Object(c.useContext)(b.a).user,t=Object(c.useContext)(O),n=t.groupDesktop,s=t.desktopInitScroll,a=t.setDesktopInitScroll,r=Object(c.useState)(null),o=Object(j.a)(r,2),l=o[0],u=o[1],p=Object(c.useState)(null),f=Object(j.a)(p,2),h=f[0],m=f[1],x=Object(c.useState)([]),v=Object(j.a)(x,2),S=v[0],k=v[1],C=Object(c.useState)(""),N=Object(j.a)(C,2),y=N[0],_=N[1],G=Object(c.useState)([]),I=Object(j.a)(G,2),M=I[0],D=I[1],P=Object(c.useState)(!1),z=Object(j.a)(P,2),E=z[0],L=z[1],A=Object(c.useRef)(null);Object(c.useEffect)((function(){var t=T.a.connect($.a.chatSocektUrl,{path:"/socket.io"});return n&&(u(t),t.emit("joinGroup",e.id,n._id),t.on("initMessages",(function(e){"success"===e.status?k(e.data):m(e.data.name)})),t.on("message",(function(e){"success"===e.status?k((function(t){return[].concat(Object(i.a)(t),[e.data])})):m(e.data)})),t.on("typing",(function(e){if("on"===e.status){var t=n.users.find((function(t){return t._id===e.user}));D([].concat(Object(i.a)(M),[t]))}else{var c=M.filter((function(t){return t._id!==e.user}));D(c)}}))),function(){t.emit("leaveGroup")}}),[n]),Object(c.useEffect)((function(){var e;s&&(null===A||void 0===A||null===(e=A.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}))})),Object(c.useEffect)((function(){return L(!1)}),[n]);var W=function(e){return l.emit("typing",e)};return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("div",{className:"desktop-messages",onScroll:function(){return a(!1)},children:[(null===S||void 0===S?void 0:S.length)>0?S.map((function(e){return Object(d.jsx)(R,{message:e,type:"desktop"},e._id)})):null,Object(d.jsx)("div",{ref:A})]}),null===M||void 0===M?void 0:M.map((function(e){return Object(d.jsx)("span",{className:"loading-dots",children:e.username})})),Object(d.jsx)(g.a,{className:"desktop-messages-input",placeholder:"type message..",variant:"outlined",fullWidth:!0,size:"small",multiline:!0,value:y,onBlur:function(){return W("off")},onFocus:function(){E||(l.emit("markMessagesAsSeen"),L(!0)),W("on")},onChange:function(e){return _(e.target.value)},InputProps:{endAdornment:Object(d.jsx)(Q.a,{onClick:function(){""!==y&&(l.emit("message",y,n._id,e.id),_(""))},style:{cursor:"pointer"},fontSize:"small",color:"primary"})}}),h&&Object(d.jsx)(Z,{type:"error",message:h,closeAction:function(){return m(null)}})]})},te=(n(333),function(){var e=Object(c.useContext)(O).groupDesktop;return Object(d.jsxs)("div",{className:"conversation-desktop",children:[Object(d.jsx)("div",{className:"desktop-conversations",children:Object(d.jsx)(w,{})}),Object(d.jsx)("div",{className:"desktop-messages",children:e?Object(d.jsx)(ee,{}):null})]})}),ne=(n(334),function(){var e=Object(c.useContext)(O),t=e.groupMobile,n=e.setGroupMobile,s=e.setOpen,a=Object(c.useContext)(_),r=a.groupList,i=a.searchGroup,o=a.setIsSearching,l=a.searchingPhrase,u=a.setSearchingPhrase;return Object(d.jsxs)("div",{className:"mobile-conversations-container",children:[Object(d.jsx)("div",{className:"mobile-conversations",children:null===r||void 0===r?void 0:r.map((function(e){var c=e.notSeenMessages,s=e.group;return Object(d.jsxs)("div",{className:"".concat((null===t||void 0===t?void 0:t._id)===s._id?"conversation-active":""," conversations-item"),children:[Object(d.jsxs)("div",{className:"conversation-item-text-container",onClick:function(){return n(s)},children:[c>0?Object(d.jsx)(M.a,{max:99,badgeContent:c,color:"primary",anchorOrigin:{vertical:"top",horizontal:"right"},children:Object(d.jsx)(D.a,{children:s.users.length>2?Object(d.jsx)(L.a,{}):null})}):Object(d.jsx)(D.a,{children:s.users.length>2?Object(d.jsx)(L.a,{}):null}),Object(d.jsx)("span",{className:"conversation-item-text",children:s.name})]}),Object(d.jsx)("a",{className:"conversation-video-link",href:"/remoTalky.client/#/videoCall/".concat(s._id),target:"_blank",rel:"noreferrer",children:Object(d.jsx)(W.a,{})})]},s._id)}))}),Object(d.jsx)(g.a,{className:"mobile-conversations-search",placeholder:"find conversation",variant:"outlined",fullWidth:!0,size:"small",value:l,onChange:function(e){""===e.target.value?(o(!1),u("")):(o(!0),i(e.target.value))},InputProps:{endAdornment:Object(d.jsx)("span",{children:Object(d.jsx)(z.a,{className:"mobile-conversations-search-icon",color:"primary",fontSize:"small",onClick:function(){return s(!0)}})})}})]})}),ce=(n(335),function(){var e=Object(c.useContext)(O),t=e.groupMobile,n=e.setGroupMobile,s=Object(c.useContext)(b.a).user,a=Object(c.useState)(null),r=Object(j.a)(a,2),o=r[0],l=r[1],u=Object(c.useState)(null),p=Object(j.a)(u,2),h=(p[0],p[1]),m=Object(c.useState)([]),x=Object(j.a)(m,2),v=x[0],S=x[1],k=Object(c.useState)(""),C=Object(j.a)(k,2),N=C[0],y=C[1],_=Object(c.useState)([]),G=Object(j.a)(_,2),I=G[0],M=G[1],D=Object(c.useState)(!1),P=Object(j.a)(D,2),z=P[0],E=P[1],L=Object(c.useState)(!0),A=Object(j.a)(L,2),W=A[0],w=A[1],F=Object(c.useRef)(null);Object(c.useEffect)((function(){var e=T.a.connect($.a.chatSocektUrl,{path:"/socket.io"});return t&&(l(e),e.emit("joinGroup",s.id,t._id),e.on("initMessages",(function(e){"success"===e.status?S(e.data):h(e.data)})),e.on("message",(function(e){"success"===e.status?(console.log(e),S((function(t){return[].concat(Object(i.a)(t),[e.data])}))):h(e.data.name)})),e.on("typing",(function(e){if("on"===e.status){var n=t.users.find((function(t){return t._id===e.user}));M([].concat(Object(i.a)(I),[n]))}else{var c=I.filter((function(t){return t._id!==e.user}));M(c)}}))),function(){e.emit("leaveGroup")}}),[t]),Object(c.useEffect)((function(){var e;W&&(null===F||void 0===F||null===(e=F.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}))}));var V=function(e){return o.emit("typing",e)};return Object(d.jsxs)(f.a,{fullScreen:!0,open:!!t,className:"mobile-messages",children:[Object(d.jsxs)("div",{className:"mobile-messages-bar",children:[Object(d.jsx)(K.a,{edge:"start",color:"inherit",onClick:function(){E(!1),n(null),w(!0)},"aria-label":"close",children:Object(d.jsx)(Y.a,{})}),(null===t||void 0===t?void 0:t.name)&&Object(d.jsx)("span",{children:t.name})]}),Object(d.jsxs)("div",{className:"mobile-messages-content",onScroll:function(){return w(!1)},children:[(null===v||void 0===v?void 0:v.length)>0?v.map((function(e){return Object(d.jsx)(R,{message:e,type:"mobile"},e._id)})):null,Object(d.jsx)("div",{ref:F})]}),null===I||void 0===I?void 0:I.map((function(e){return Object(d.jsx)("span",{className:"loading-dots",children:e.username})})),Object(d.jsx)(g.a,{className:"mobile-messages-input",placeholder:"type message..",variant:"outlined",size:"small",multiline:!0,value:N,onBlur:function(){return V("off")},onFocus:function(){z||(o.emit("markMessagesAsSeen"),E(!0)),V("on")},onChange:function(e){return y(e.target.value)},InputProps:{endAdornment:Object(d.jsx)(Q.a,{onClick:function(){""!==N&&(o.emit("message",N,t._id,s.id),y(""))},style:{cursor:"pointer"},fontSize:"small",color:"primary"})}})]})}),se=function(){return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(ne,{}),Object(d.jsx)(ce,{})]})};t.default=function(){var e=Object(a.useMediaQuery)({minWidth:800});return Object(d.jsx)(s.a,{children:Object(d.jsx)(p,{children:Object(d.jsxs)(G,{children:[e?Object(d.jsx)(te,{}):Object(d.jsx)(se,{}),Object(d.jsx)(I,{})]})})})}}}]);
//# sourceMappingURL=8.6405574c.chunk.js.map